# NOVIX V2 æ¶æ„è®¾è®¡ï¼šæµå¼æ’°å†™ + å·®å¼‚ç¼–è¾‘

> **ç›®æ ‡**ï¼šé‡æ–°è®¾è®¡å¤šæ™ºèƒ½ä½“æµç¨‹å’Œå‰ç«¯äº¤äº’ï¼Œå®ç°"ç±» Chat äº§å“"çš„é€å­—ç”Ÿæˆä½“éªŒå’Œ"ç±» AI Coding äº§å“"çš„å¢åˆ å·®å¼‚å¯è§†åŒ–ã€‚

---

## ä¸€ã€æ ¸å¿ƒè®¾è®¡å˜æ›´

### 1.1 ç®€åŒ– Agent æµç¨‹

| åœºæ™¯ | V1 (å½“å‰) | V2 (ç›®æ ‡) |
|---|---|---|
| æ–°å»ºç« èŠ‚ | Archivist â†’ Writer â†’ Reviewer â†’ Editor (4 è°ƒç”¨) | Archivist â†’ Writer (2 è°ƒç”¨) |
| ç¼–è¾‘ä¿®æ”¹ | N/A (é‡æ–°è·‘å…¨æµç¨‹?) | Editor only (1 è°ƒç”¨) |
| å®¡ç¨¿äºº | å­˜åœ¨ | **å½»åº•ç§»é™¤** |

**å˜æ›´ç†ç”±**ï¼š
- Reviewer çš„ä»·å€¼å¯ä»¥ç”±ç”¨æˆ·åé¦ˆæ›¿ä»£ï¼ˆç”¨æˆ·å°±æ˜¯æœ€å¥½çš„å®¡ç¨¿äººï¼‰ã€‚
- å‡å°‘ LLM è°ƒç”¨æ¬¡æ•° = æ›´å¿«é€Ÿåº¦ + æ›´ä½æˆæœ¬ã€‚

### 1.2 é‡æ–°å®šä¹‰ Agent èŒè´£

| Agent | æ–°èŒè´£ |
|---|---|
| **Archivist (æ¡£æ¡ˆå‘˜)** | **ä¸Šä¸‹æ–‡ç­–å±•äºº (Context Curator)**ã€‚è´Ÿè´£ç­›é€‰ã€æ•´åˆæ‰€æœ‰ç›¸å…³ Cards/Facts/Summariesï¼Œè¾“å‡ºä¸€ä»½ç²¾ç®€çš„ `ContextPackage`ã€‚Writer å’Œ Editor **åªèƒ½çœ‹åˆ° Archivist æä¾›çš„ä¿¡æ¯**ã€‚ |
| **Writer (ä¸»ç¬”)** | æ ¹æ® `ContextPackage` å’Œç« èŠ‚ç›®æ ‡ï¼Œ**æµå¼** è¾“å‡ºè‰ç¨¿ã€‚ |
| **Editor (ç¼–è¾‘)** | æ ¹æ®ç”¨æˆ·åé¦ˆï¼Œå¯¹æ¯”åŸç¨¿ç”Ÿæˆ **ç»“æ„åŒ– Diff**ï¼ˆå¢/åˆ /æ”¹ï¼‰ã€‚ |

---

## äºŒã€ç”¨æˆ·ä½“éªŒæµç¨‹

### 2.1 æ–°å»ºç« èŠ‚ (Create Mode)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¾“å…¥: "ç¬¬ä¸‰ç« ï¼šä¸»è§’å‘ç°äº†ç¥ç§˜æ´ç©´ï¼Œç›®æ ‡3000å­—"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å³ä¾§æ çŠ¶æ€] ğŸ“š æ¡£æ¡ˆå‘˜æ­£åœ¨æ•´ç†è®¾å®š...                              â”‚
â”‚   - åŠ è½½è§’è‰²å¡: ä¸»è§’ã€NPC                                        â”‚
â”‚   - åŠ è½½ä¸–ç•Œè§‚: æ´ç©´åœ°å›¾                                          â”‚
â”‚   - ç­›é€‰ç›¸å…³å‰æ–‡æ‘˜è¦                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–¼ (1-2ç§’)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å³ä¾§æ çŠ¶æ€] âœï¸ ä¸»ç¬”æ­£åœ¨æ’°å†™...                                    â”‚
â”‚                                                                   â”‚
â”‚ [ä¸­å¤®ç¼–è¾‘åŒº - é€å­—è¾“å‡º]                                            â”‚
â”‚ > |                                                               â”‚
â”‚ > å±±|                                                             â”‚
â”‚ > å±±é£|                                                           â”‚
â”‚ > å±±é£å‘¼|å•¸|ï¼Œ|è®¸|æ˜Š|é¾™|ç«™|åœ¨|æ´|å£|...                             â”‚
â”‚                                                                   â”‚
â”‚ (æ–‡å­—ä¸€ä¸ªä¸€ä¸ªè¹¦å‡ºæ¥ï¼Œå°±åƒ ChatGPT çš„ä½“éªŒ)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç¼–è¾‘ä¿®æ”¹ (Edit Mode)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¾“å…¥: "ç¬¬äºŒæ®µå¤ªé•¿äº†ï¼Œæ‹†æˆä¸¤æ®µï¼Œè¯­æ°”å†æ¿€çƒˆä¸€ç‚¹"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å³ä¾§æ çŠ¶æ€] ğŸ“ ç¼–è¾‘æ­£åœ¨ä¿®æ”¹...                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–¼ (ç­‰å¾… LLM è¿”å›)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ä¸­å¤®ç¼–è¾‘åŒº - Diff è§†å›¾]                                           â”‚
â”‚                                                                   â”‚
â”‚   å±±é£å‘¼å•¸ï¼Œè®¸æ˜Šé¾™ç«™åœ¨æ´å£ã€‚                                        â”‚
â”‚ - ä»–çš„å¿ƒè·³åŠ é€Ÿï¼Œè¿™ç‰‡é»‘æš—è®©ä»–æƒ³èµ·ç«¥å¹´çš„å™©æ¢¦ï¼Œä½†ä»–å¿…é¡»å‰è¿›ï¼Œ           â”‚
â”‚ - å› ä¸ºé˜¿æ¢“è¿˜åœ¨é‡Œé¢ç­‰ç€ä»–ã€‚                                          â”‚
â”‚ + ä»–çš„å¿ƒè·³å¦‚æ“‚é¼“ã€‚è¿™ç‰‡é»‘æš—è®©ä»–æƒ³èµ·ç«¥å¹´çš„å™©æ¢¦ã€‚                       â”‚
â”‚ +                                                                  â”‚
â”‚ + ä½†ä»–å¿…é¡»å‰è¿›â€”â€”é˜¿æ¢“è¿˜åœ¨é‡Œé¢ï¼                                     â”‚
â”‚                                                                   â”‚
â”‚ [æŒ‰é’®: âœ“ æ¥å—å…¨éƒ¨ | âœ— æ‹’ç»å…¨éƒ¨ | é€æ¡å®¡é˜…]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æŠ€æœ¯æ–¹æ¡ˆ

### 3.1 åç«¯ï¼šæµå¼ LLM æ¥å£

#### 3.1.1 `BaseLLMProvider` æ–°å¢ `stream_chat`

```python
# backend/app/llm_gateway/providers/base.py

from typing import AsyncGenerator

class BaseLLMProvider(ABC):
    # ... existing chat() ...

    @abstractmethod
    async def stream_chat(
        self,
        messages: List[Dict[str, str]],
        temperature: Optional[float] = None,
        max_tokens: Optional[int] = None
    ) -> AsyncGenerator[str, None]:
        """æµå¼è¾“å‡ºï¼Œæ¯æ¬¡ yield ä¸€ä¸ª token æˆ– chunk"""
        pass
```

#### 3.1.2 `OpenAIProvider` / `DeepSeekProvider` å®ç°

```python
# backend/app/llm_gateway/providers/openai_provider.py

async def stream_chat(self, messages, temperature=None, max_tokens=None):
    response = await self.client.chat.completions.create(
        model=self.model,
        messages=messages,
        temperature=temperature or self.temperature,
        max_tokens=max_tokens or self.max_tokens,
        stream=True  # å…³é”®ï¼
    )
    async for chunk in response:
        if chunk.choices[0].delta.content:
            yield chunk.choices[0].delta.content
```

### 3.2 åç«¯ï¼šArchivist è¾“å‡º `ContextPackage`

```python
# backend/app/agents/archivist.py

class ArchivistAgent(BaseAgent):
    async def execute(self, ...) -> Dict[str, Any]:
        # ... ç°æœ‰çš„ç­›é€‰é€»è¾‘ ...
        
        # æ–°å¢: è¾“å‡ºæ ‡å‡†åŒ–çš„ ContextPackage
        return {
            "success": True,
            "context_package": {
                "brief": scene_brief,             # åœºæ™¯ç®€æŠ¥ (ç²¾ç®€ç‰ˆ)
                "characters": selected_characters, # ä»…ç›¸å…³è§’è‰²
                "world_facts": selected_facts,    # ä»…ç›¸å…³è®¾å®š
                "previous_summary": compressed_summary  # å‹ç¼©åçš„å‰æ–‡
            }
        }
```

### 3.3 åç«¯ï¼šWriter æµå¼è¾“å‡º

```python
# backend/app/agents/writer.py

class WriterAgent(BaseAgent):
    async def execute_stream(
        self,
        project_id: str,
        chapter: str,
        context_package: Dict[str, Any]  # æ¥è‡ª Archivist
    ) -> AsyncGenerator[str, None]:
        """æµå¼ç”Ÿæˆè‰ç¨¿"""
        messages = self._build_messages(context_package)
        
        async for token in self.gateway.stream_chat(messages):
            yield token  # é€ token æ¨é€
```

### 3.4 åç«¯ï¼šEditor è¾“å‡º Diff

```python
# backend/app/agents/editor.py

import difflib

class EditorAgent(BaseAgent):
    async def execute(self, ...) -> Dict[str, Any]:
        # ... ç”Ÿæˆä¿®è®¢ç¨¿ ...
        
        # æ–°å¢: è®¡ç®—ç»“æ„åŒ– Diff
        original_lines = original_draft.splitlines(keepends=True)
        revised_lines = revised_draft.splitlines(keepends=True)
        
        diff = list(difflib.unified_diff(
            original_lines, 
            revised_lines,
            fromfile='original',
            tofile='revised',
            lineterm=''
        ))
        
        return {
            "success": True,
            "revised_draft": revised_draft,
            "diff": diff,  # æ ‡å‡† Unified Diff æ ¼å¼
            "hunks": self._parse_hunks(diff)  # è§£ææˆå‰ç«¯å‹å¥½çš„ç»“æ„
        }
```

### 3.5 WebSocket æ¨é€æµå¼å†…å®¹

```python
# backend/app/routers/session.py (æ–°å¢æˆ–ä¿®æ”¹)

@router.websocket("/ws/{project_id}/stream")
async def writer_stream_endpoint(websocket: WebSocket, project_id: str):
    await websocket.accept()
    
    # æ‰§è¡Œæµå¼å†™ä½œ
    async for token in writer_agent.execute_stream(project_id, chapter, context):
        await websocket.send_json({
            "type": "token",
            "content": token
        })
    
    await websocket.send_json({"type": "done"})
```

### 3.6 å‰ç«¯ï¼šæµå¼è‰ç¨¿è§†å›¾

```jsx
// frontend/src/components/ide/StreamingDraftView.jsx

const StreamingDraftView = ({ projectId, chapter }) => {
    const [content, setContent] = useState('');
    
    useEffect(() => {
        const ws = new WebSocket(`ws://localhost:8000/ws/${projectId}/stream`);
        
        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            if (data.type === 'token') {
                setContent(prev => prev + data.content);  // é€å­—è¿½åŠ 
            }
        };
        
        return () => ws.close();
    }, [projectId, chapter]);
    
    return (
        <div className="draft-editor prose">
            {content}
            <span className="cursor-blink">|</span>  {/* æ‰“å­—æœºå…‰æ ‡ */}
        </div>
    );
};
```

### 3.7 å‰ç«¯ï¼šDiff å®¡é˜…è§†å›¾

```jsx
// frontend/src/components/ide/DiffReviewView.jsx

import { Diff, Hunk, parseDiff } from 'react-diff-view';
import 'react-diff-view/style/index.css';

const DiffReviewView = ({ diff }) => {
    const files = parseDiff(diff.join(''));
    
    return (
        <div className="diff-viewer">
            {files.map(file => (
                <Diff 
                    key={file.oldPath}
                    viewType="unified"
                    diffType={file.type}
                    hunks={file.hunks}
                />
            ))}
            
            <div className="diff-actions">
                <Button variant="primary">âœ“ æ¥å—å…¨éƒ¨</Button>
                <Button variant="outline">âœ— æ‹’ç»å…¨éƒ¨</Button>
            </div>
        </div>
    );
};
```

---

## å››ã€Token ä¼˜åŒ–æ•ˆæœé¢„ä¼°

| æŒ‡æ ‡ | V1 | V2 | èŠ‚çœ |
|---|---|---|---|
| LLM è°ƒç”¨æ¬¡æ•° (æ–°å»º) | 4 | 2 | -50% |
| æ€» Token (æ–°å»º) | ~23k | ~12k | -48% |
| æ€» Token (ç¼–è¾‘) | ~23k (å…¨æµç¨‹) | ~6k (ä»… Editor) | -74% |
| ç”¨æˆ·æ„ŸçŸ¥å»¶è¿Ÿ | 10 min (é˜»å¡) | <30s (é¦–å­—æµå‡º) | é©å‘½æ€§æ”¹è¿› |

---

## äº”ã€å®æ–½æ­¥éª¤ (Phased Rollout)

### Phase 1: æµå¼ Writer (P0, é¢„è®¡ 2 å¤©)
1. `BaseLLMProvider` æ–°å¢ `stream_chat` æŠ½è±¡æ–¹æ³•ã€‚
2. `OpenAIProvider`, `DeepSeekProvider` å®ç°æµå¼é€»è¾‘ã€‚
3. `WriterAgent` æ–°å¢ `execute_stream` æ–¹æ³•ã€‚
4. æ–°å¢ WebSocket ç«¯ç‚¹ `/ws/{project_id}/stream`ã€‚
5. å‰ç«¯ `StreamingDraftView` ç»„ä»¶ã€‚

### Phase 2: ç§»é™¤ Reviewer & ç²¾ç®€æµç¨‹ (P0, é¢„è®¡ 1 å¤©)
1. ä¿®æ”¹ `Orchestrator.start_session`ï¼Œç§»é™¤ Reviewer è°ƒç”¨ã€‚
2. Archivist è¾“å‡ºæ ‡å‡†åŒ– `ContextPackage`ã€‚
3. Writer/Editor ä»…æ¥æ”¶ `ContextPackage`ï¼Œä¸å†è‡ªè¡ŒåŠ è½½ Cardsã€‚

### Phase 3: Editor Diff å¯è§†åŒ– (P1, é¢„è®¡ 2 å¤©)
1. `EditorAgent` è¾“å‡º `diff` å’Œ `hunks`ã€‚
2. å‰ç«¯é›†æˆ `react-diff-view` æˆ–è‡ªç ” Diff ç»„ä»¶ã€‚
3. å®ç°"æ¥å—/æ‹’ç»"æŒ‰é’®é€»è¾‘ã€‚

### Phase 4: è¿­ä»£åé¦ˆé—­ç¯ (P2, é¢„è®¡ 1 å¤©)
1. ç”¨æˆ·å¯å¤šæ¬¡æäº¤åé¦ˆï¼ŒEditor å¤šè½®ä¿®æ”¹ã€‚
2. ç‰ˆæœ¬å†å²ç®¡ç† (v1 â†’ v2 â†’ v3...)ã€‚

---

## å…­ã€å†³ç­–ç¡®è®¤ âœ…

1. **ç¼–è¾‘æ¨¡å¼æ—¶æ˜¯å¦é‡æ–°è°ƒç”¨ Archivistï¼Ÿ**
   - **å†³å®š**: ä¸è°ƒç”¨ã€‚Editor å¤ç”¨åˆæ¬¡ç”Ÿæˆæ—¶çš„ `ContextPackage`ã€‚
   - **ç†ç”±**: æ›´å¿«ï¼Œä¸”ç”¨æˆ·åé¦ˆé€šå¸¸é’ˆå¯¹å½“å‰ Context è¶³å¤Ÿã€‚

2. **æµå¼è¾“å‡ºçš„ Token ç»Ÿè®¡å¦‚ä½•å¤„ç†ï¼Ÿ**
   - **å†³å®š**: æœ¬åœ°ä¼°ç®— (ä¸­æ–‡: å­—ç¬¦æ•° Ã· 2ï¼Œè‹±æ–‡: å­—ç¬¦æ•° Ã· 4)ã€‚
   - **ç†ç”±**: é¿å…é¢å¤– API è°ƒç”¨ï¼Œæµç»“æŸåå¯é€‰æ‹©æ€§æ ¡å‡†ã€‚

3. **Diff çš„ç²’åº¦ï¼Ÿ**
   - **å†³å®š**: è¡Œçº§ Diff (ç±»ä¼¼ Git)ã€‚
   - **ç†ç”±**: æ›´è´´è¿‘ç”¨æˆ·"æ®µè½"å¿ƒæ™ºæ¨¡å‹ï¼Œé¿å…å­—çº§ Diff çš„è§†è§‰å™ªéŸ³ã€‚

---

## é™„å½•ï¼šæ¶æ„å¯¹æ¯”å›¾

```
V1 (å½“å‰):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Archivistâ”‚â”€â”€â”€â–¶â”‚ Writer  â”‚â”€â”€â”€â–¶â”‚Reviewer â”‚â”€â”€â”€â–¶â”‚ Editor  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â–¼              â–¼              â–¼              â–¼
  [cards]       [cards]        [draft]        [draft]
  [facts]       [facts]        [issues]       [review]
                [brief]

V2 (ç›®æ ‡):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Archivist        â”‚  â”€â”€â”€ å”¯ä¸€çš„ä¸Šä¸‹æ–‡å…¥å£
â”‚  (Context Curator)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ ContextPackage
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Writer         â”‚          â”‚       Editor         â”‚
â”‚   (Streaming LLM)    â”‚   â—€â”€â”€â”€â”€  â”‚   (Diff Generator)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  ç”¨æˆ·    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚              åé¦ˆ              â”‚
           â–¼                               â–¼
    [é€å­—è¾“å‡º UI]                    [Diff å¯è§†åŒ– UI]
```
